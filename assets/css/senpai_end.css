/* ========== Base ========== */
* { margin: 0; }
body { background-color: #000; }

.senpai_end { position: relative; height: 100vh; }
.imge{
  position: relative;
  height: 100vh;
  background-image: url(/assets/img/先輩とハッピーエンド.png);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* ボタン */
.button-container {
  position: absolute;
  left: 50%;
  bottom: 2rem;
  transform: translateX(-50%);
}
.link-button {
  display: inline-block;
  padding: 12px 28px;
  font-size: 20px;
  line-height: 1;
  text-decoration: none;
  color: #2a241a;
  background: #e6dcc7;
  border: 1.5px solid #3c352a;
  border-radius: 6px;
  font-family: "Noto Serif JP", serif;
  letter-spacing: 0.08em;
  box-shadow:
    0 1px 0 rgba(0,0,0,0.25) inset,
    0 6px 18px rgba(0,0,0,0.35);
  transition: transform .15s ease, box-shadow .15s ease, filter .15s ease;
  filter: sepia(0.15) saturate(0.9);
}
.link-button:hover {
  transform: translateY(-2px);
  box-shadow:
    0 1px 0 rgba(0,0,0,0.25) inset,
    0 10px 22px rgba(0,0,0,0.45);
}
.link-button:active {
  transform: translateY(0);
  box-shadow:
    0 0 0 rgba(0,0,0,0.25) inset,
    0 4px 12px rgba(0,0,0,0.35);
}

/* ========== Title Vars ========== */
:root{
  /* ベース */
  --end-font: "Noto Serif JP", serif;
  --end-weight: 700;
  --end-letter: .08em;

  /* 色／発光 */
  --end-color: #e7ce3a;
  --end-stroke: rgba(35,28,12,.55);
  --end-shadow1: #433a1f;
  --end-glow1: rgba(207,175,40,.25);
  --end-glow2: rgba(207,175,40,.18);

  /* 位置／サイズ */
  --end-top: min(5vh, 5px);
  --end-size: clamp(26px, 5.2vw, 70px);

  /* ブレンド／質感 */
  --end-blend: screen;
  --end-filter: saturate(.8) sepia(.25);

  /* 汚しの強さ */
  --grime-opacity: .45;
}

/* ========== Title Base ========== */
.ending-title{
  position: absolute;
  top: var(--end-top);
  left: 50%;
  transform: translateX(-50%);
  margin: 0;
  padding: .15em .35em;

  font-family: var(--end-font);
  font-weight: var(--end-weight);
  font-size: var(--end-size);
  letter-spacing: var(--end-letter);

  color: var(--end-color);
  filter: var(--end-filter);
  text-shadow:
    0 0.02em 0 var(--end-shadow1),
    0 0 8px var(--end-glow1),
    0 0 18px var(--end-glow2);
  -webkit-text-stroke: 1px var(--end-stroke);
  mix-blend-mode: var(--end-blend);
  pointer-events: none;
}

/* “紙汚れ” */
.ending-title--grime::after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(8px 8px at 20% 30%, rgba(0,0,0,.22) 0 40%, transparent 41%) repeat,
    radial-gradient(6px 6px at 70% 60%, rgba(0,0,0,.18) 0 40%, transparent 41%) repeat,
    radial-gradient(5px 5px at 40% 80%, rgba(0,0,0,.16) 0 40%, transparent 41%) repeat;
  background-size: 38px 32px, 34px 28px, 26px 24px;
  mix-blend-mode: multiply;
  opacity: var(--grime-opacity);
  border-radius: .08em;
  pointer-events: none;
}

/* スマホ */
@media (max-width: 480px){
  :root{
    --end-top: 3vh;
    --end-size: clamp(22px, 6vw, 40px);
    --end-letter: .06em;
  }
}

/* ========== Brush Look (筆文字風) ========== */
.ending-title--brush{
  font-family: "Yuji Boku","Hiragino Mincho ProN","Yu Mincho",serif;
  font-weight: 400;
  letter-spacing: .06em;
  color: #f0cf28;
  -webkit-text-stroke: 1.1px rgba(30,22,8,.65);
  text-shadow:
    0 .04em 0 #3e331c,
    0 0 10px rgba(230,198,60,.28),
    0 0 22px rgba(230,198,60,.18);
  filter: saturate(.85) sepia(.25);
  mix-blend-mode: screen;
}
.ending-title--brush > span{
  display:inline-block;
  padding: .2em .38em;
  filter: url(#ink-bleed); /* エッジの揺れ */
  position: relative;
}

/* ========== Two-line Layout (1行目:左 / 最終行:右) ========== */
.ending-title .title-line{
  display: inline-block;
  width: min(92vw, 560px);  /* ← 必要ならここだけ調整 */
  white-space: normal;
  line-height: 1.1;
  text-align: left;         /* 1行目＝左寄せ */
  text-align-last: right;   /* 最終行＝右寄せ */
  -moz-text-align-last: right;
}


/* キラッ演出：::after → ::before に変更 */
.ending-title .title-line{
  position: relative;
}

/* .ending-title .title-line::before{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background: linear-gradient(
    115deg,
    rgba(255,255,210,0) 30%,
    rgba(255,255,210,.85) 48%,
    rgba(255,255,210,0) 66%
  ); */
  /* mix-blend-mode: screen;
  filter: blur(1px);
  transform: translateX(-130%) rotate(0.001deg);
  animation: glint 1.2s ease-out 1 0.25s;  /* 一度だけキラッ */
  /* opacity: 0;
  z-index: 1; /* 必要なら */

  /* 位置は変えない：2行レイアウトのまま */
.ending-title .title-line{
  position: relative;
  display: inline-block;
  width: min(92vw, 560px);
  line-height: 1.1;
  white-space: normal;        /* 自然改行（2行） */
  text-align: left;           /* 1行目 */
  text-align-last: right;     /* 最終行（= Ending の行） */
  -moz-text-align-last: right;
  word-break: keep-all;       /* ★重要：単語の途中で折り返さない */
}

/* 1文字アニメ。インラインのまま＝レイアウトに影響させない */
.title-line .ch{
  display: inline;
  animation: chTwinkle 1.8s ease-in-out infinite;
  animation-delay: calc(var(--i) * var(--ch-step, .12s));
  will-change: filter, opacity, text-shadow;
}

@keyframes chTwinkle{
  0%   { opacity:.9;  filter:brightness(1); }
  20%  { opacity:1;   filter:brightness(1.9); text-shadow:0 0 10px rgba(255,245,170,.35); }
  40%  { opacity:.92; filter:brightness(1.2); text-shadow:0 0 4px  rgba(255,245,170,.15); }
  60%  { opacity:1;   filter:brightness(2.2); text-shadow:0 0 14px rgba(255,245,170,.45); }
  100% { opacity:.9;  filter:brightness(1);   text-shadow:none; }
}

@media (prefers-reduced-motion: reduce){
  .title-line .ch{ animation: none; }
}



@keyframes glint{
  0%   { transform: translateX(-130%); opacity: 0; }
  15%  { opacity: .9; }
  60%  { opacity: .7; }
  100% { transform: translateX(130%);  opacity: 0; }
}


/*下記を追加 @mediaまで　10/9 21:40*/
:root { --ch-step: .12s; }           /* 1文字ごとのディレイ */

.ending-title .title-line { position: relative; }

/* 1文字ずつの明滅（レイアウトを変えない＝transformは使わない） */
.title-line .ch{
  display: inline;                   /* インラインのまま＝位置が微動だにしない */
  animation: chTwinkle 1.8s ease-in-out infinite;
  animation-delay: calc(var(--i) * var(--ch-step));
  will-change: filter, opacity, text-shadow;
}

@keyframes chTwinkle{
  0%   { opacity:.9; filter:brightness(1); }
  20%  { opacity:1;  filter:brightness(1.9); text-shadow: 0 0 10px rgba(255,245,170,.35); }
  40%  { opacity:.92; filter:brightness(1.2); text-shadow: 0 0 4px  rgba(255,245,170,.15); }
  60%  { opacity:1;  filter:brightness(2.2); text-shadow: 0 0 14px rgba(255,245,170,.45); }
  100% { opacity:.9; filter:brightness(1);  text-shadow: none; }
}

/* 動きを抑えたいユーザー配慮 */
@media (prefers-reduced-motion: reduce){
  .title-line .ch{ animation: none; }
}
